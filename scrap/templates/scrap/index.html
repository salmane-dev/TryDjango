{% extends "base.html" %}

{% block title %}My scraping project{% endblock %}
 
{% block content %}
 
 <!-- Icons Grid-->
 <section class="features-icons bg-light text-center">
  <div class="container">
            <h2>OKAAAY, LET'S GOOOO</h2> 
            <div class="row d-flex justify-content-between m-0">
              {% for article in articles %}
              <div class="col-lg-4 p-3">
                  <a href={{ article.mylink }} class=" col-lg-3  ">
                      <div>
                          <img src={{ article.img }} alt={{ article.text }} class="w-100" >
                      </div>
                      <h5>{{ article.text }}</h5>
                  </a>
                </div>
              {% endfor %}
            </div>
            <button class="p-2 px-5 load_more visible" >More</button>
            <br>
          </div>
        
          <div class="spinner-border text-primary mt-2 not-visible" role="status" id="spinner">
            <span class="sr-only"></span>
          </div>

          <small >  page  {{ page }}    </small>
        </section>  




<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" >
</script>

<script>

console.log("Gooolaaacooo")
  
   
  console.log($(".load_more").text())
  
 
    $(".load_more").click(function(){
       
      const spinner = document.getElementById('spinner');
      $("#spinner").removeClass("not-visible");


      if($(this).text() == "More") {
      $.ajax({
                url: 'http://127.0.0.1:8000/scrap/more_blogs',
                type: 'GET',
                data: {
                    'page': "{{page}}"
                },
                // beforeSend: function () {
                //     loadBtn.classList.add('not-visible');
                //     spinner.classList.remove('not-visible');
                // },
                success: function (response) {
                    const data = response.posts
                    // spinner.classList.add('not-visible')
                    data.map(post => {
                        console.log(post.title);
                        content_container.innerHTML += `<div class="single_content border border-success mt-2 pl-2">
                                                            <h3>${post.title}</h3>
                                                            <p>${post.desc}</p>
                                                        </div>`
                    })
                    if (_current_item == total) {
                        alert.classList.remove('not-visible');
                    } else {
                        loadBtn.classList.remove('not-visible');
                    }
                },
                error: function (err) {
                    console.log(err);
                },
            });
          }
          else{
            $(this).text("traaaaaaa"); 
            console.log("Gooolaaacooo")
          }

    });  
 






</script>







{% endblock %}