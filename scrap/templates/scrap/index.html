{% extends "base.html" %}

{% block title %}My scraping project{% endblock %}
 
{% block content %}
 
 <!-- Icons Grid-->
 <section class="features-icons bg-light text-center">
  <div class="container">
            <h2>OKAAAY, LET'S GOOOO</h2> 
            <div id="posts" class="row d-flex justify-content-between m-0">
              {% for article in articles %}
              <div class="col-lg-4 p-3">
                  <a href={{ article.mylink }} class=" col-lg-3  ">
                      <div>
                          <img src={{ article.img }} alt={{ article.text }} class="w-100" >
                      </div>
                      <h5>{{ article.text }}</h5>
                  </a>
                </div>
              {% endfor %}
            </div>
            <button class="p-2 px-5 load_more visible" >More</button>
            <!-- <a href="http://127.0.0.1:8000/scrap/?page=5">More</a> -->
             <br>
          </div>
        
          <div class="spinner-border text-primary mt-2 not-visible" role="status" id="spinner">
            <span class="sr-only"></span>
          </div>
 
        </section>  

        <div class="container text-center" >
          page<small> {{ page }} </small>
        </div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" >
</script>

<script>

    $(".load_more").click(function(){
      const spinner = document.getElementById('spinner');
      $("#spinner").removeClass("not-visible");
        if($(this).text() == "More") {
        $.ajax({
                  url: "http://127.0.0.1:8000/scrap/more_blogs/?page={{page}}",
                  type: 'GET',
                  // data: {
                  //     'page': 5
                  // },
                  // beforeSend: function () {
                  //     loadBtn.classList.add('not-visible');
                  //     spinner.classList.remove('not-visible');
                  // },
                  success: function (response) {
                      const data = JSON.parse(response)  
                      // $("#posts").removeClass("not-visible");
                      for (const prop in data) {
                        console.log(`  ${data[prop].text}`);





                      }
                      console.log('doooooooone')
                      $("#spinner").addClass("not-visible");

                  },
                  error: function (err) {
                      console.log(err);
                  },
              });
            }
            else{
              $(this).text("traaaaaaa"); 
              console.log("Gooolaaacooo")
            }

    });  
 






</script>







{% endblock %}